# For Node.js & React Devs

Internally manages gas estimation required by the burn tax for successful transactions on the blockchain. Makes it easier for devs to get started with payments on the LUNC/LUNA Blockchains.

## Features

- **Written in Typescript**, with type definitions
- Works with React Native, Typescript Ecosystems, in the browser, and Mobile solutions for anyone building on the Terra Ecosystem
- Makes it easier to manage payments with very simple abstractions

## Installation & Configuration

Next, grab the latest version of the payment library off of [Npm](https://www.npmjs.com/package/terra.onchainpayments)

For npm

```sh
npm i terra.onchainpayments
```

For Yarn

```sh
yarn add terra.onchainpayments
```

## Usage

This package can be used for Mobile & Web Developers, or SDK Developers looking to extend the Terra Platform

Please note: **PaymentsManager** must be registered as a Singleton to prevent issues with the Connection Pool.

## Manage Payments

First, [get](https://faucet.terra.money/) some testnet tokens for `terra1x46rqay4d3cssq8gxxvqz8xt6nwlz4td20k38v`, or use [LocalTerra](https://www.github.com/terra-money/LocalTerra).

```ts
// Customer wallets are the ones that make the payment, and pay for the Burn Tax
function ChargeCustomerWithLUNC() {
  let businessWallet = 'terra17lmam6zguazs5q5u6z5mmx76uj63gldnse2pdp';
  let customerKeys =
    'notice oak worry limit wrap speak medal online prefer cluster roof addict wrist behave treat actual wasp year salad speed social layer crew genius';

  var manager = new PaymentsManager({ env = Environments.ClassicTestNet })
    .configureBusinessWallet(businessWallet)
    .configureCustomerKeys(customerKeys);

  // Charge the customer a payment of 200,000 LUNC
  var tx = await manager.ChargeCustomer(200000);
  console.debug(`TX: ${tx.TxFinderHashUrl}`); // Track the Tx Url on Terra.Finder
}

function ChargeCustomerWithLUNA2() {
  let businessWallet = 'terra17lmam6zguazs5q5u6z5mmx76uj63gldnse2pdp';
  let customerKeys =
    'notice oak worry limit wrap speak medal online prefer cluster roof addict wrist behave treat actual wasp year salad speed social layer crew genius';

  var manager = new PaymentsManager({ env = Environments.Luna2TestNet })
    .configureBusinessWallet(businessWallet)
    .configureCustomerKeys(customerKeys);

  // Charge the customer a payment of 200 LUNA
  var tx = await manager.ChargeCustomer(200);
  console.debug(`TX: ${tx.TxFinderHashUrl}`); // Track the Tx Url on Terra.Finder
}
```

## terra.onchainpayments in the browser

Include the following in your browser:

```html
<script
  crossorigin
  src="https://unpkg.com/@terra-money/terra.onchainpayments/dist/bundle.js"
></script>
```

You can find a small JSFiddle example that refreshes current Oracle votes [here](https://jsfiddle.net/tLm1b527/1/).

## terra.onchainpayments in React Native

In order to use terra.onchainpayments inside React Native, you need to add the [`node-libs-react-native`](https://github.com/parshap/node-libs-react-native) package and [`react-native-get-random-values`](https://github.com/LinusU/react-native-get-random-values) package to your React Native app's `package.json`.

```sh
yarn add node-libs-react-native react-native-get-random-values
```

You will need to register Node.js native modules in an entry point of your application, such as `index.tsx`:

```js
import 'node-libs-react-native/globals';
import 'react-native-get-random-values';
```

Also, add resolvers to your `metro.config.js`

```js
module.exports {
  // ...
  resolver: {
    // ...
    extraNodeModules: require('node-libs-react-native'),
  },
  // ...
}
```
